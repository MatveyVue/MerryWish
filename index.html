<!DOCTYPE html>
<html>
<head>
  <title>Merry Wish</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Geologica:wght@100..900&display=swap" rel="stylesheet">
</head>
<body>
    <img src="https://i.postimg.cc/G2Tj9fZB/IMG-2995.png">

<center>
<div>
<form id="orderForm">
    <h1>Merri Wish</h1>
    <input style="font-size: 16px" id="Пожелание" type="text" placeholder=" Ваше пожелание" required><br>
    <p>&copyВ конце пожелания оставляйте ваш Telegram Username для получения награды в дальнейшем</p>
</form>
</div>
</center>

<style>
body {
    background-image: url('https://media0.giphy.com/media/iqn1W7iaSzQZ9DuTPU/giphy.gif?cid=9b38fe916dnmwb69gl8ywlp93aat9pl0j936gucyhjrjlo7z&ep=v1_gifs_username&rid=giphy.gif&ct=g');
    color: white;
    touch-action: none;
    overflow: none;
}
input {
    background-color: rgb(255, 255, 255);
    border: none;
    border-radius: 18px;
    width: 95%;
    height: 45px;
    margin-top: 20px;
    color: black;
}
p {
    font-family: Geologica;
    font-size: 12px;
}
h1 {
    font-family: Geologica;
    color: white;

}
img {
    width: 105vw;
    position: absolute;
    margin-top: -100vw;
    margin-left: -10px;
}
div {
    margin-top: 160px;
}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyB99Izcf6vJFkNVeTLZfukt5UCQPBFSzZ4",
        authDomain: "merry-wish.firebaseapp.com",
        databaseURL: "https://merry-wish-default-rtdb.firebaseio.com",
        projectId: "merry-wish",
        storageBucket: "merry-wish.firebasestorage.app",
        messagingSenderId: "472160350126",
        appId: "1:472160350126:web:13ccce689eccd0106be23f",
        measurementId: "G-2FV9T3RFY0"
    };

      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      const orderForm = document.getElementById("orderForm");

  orderForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const Пожелание = document.getElementById("Пожелание").value;

    if (Пожелание === "") {
      alert("Пожалуйста, заполните поле!");
      return;
    }

    try {
      await set(ref(db, 'Пожелания/' + generateUUID()), { Пожелание });
      alert("Пожелание отправлено!");
      orderForm.reset();
    } catch (error) {
      alert("Ошибка при отправке пожелания");
    }
  });
  function generateUUID() {
        return 'xx'.replace(/[xy]/g, function(c) {
          const r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
          return v.toString(16);
        });
      }

  window.Telegram.WebApp.ready();
  window.Telegram.WebApp.MainButton.show();
  window.Telegram.WebApp.MainButton.text = "Отправить";

  window.Telegram.WebApp.MainButton.onClick = async () => {
    // Вызываем отправку формы
    orderForm.dispatchEvent(new Event('submit'));
  };
</script>
</body>
</html>
</body>
</html>
